function [branch,weight] = branchweight(brn,weightopt)
%% Computes the weights for the selected model
% brn - is the number of branches in the selected model (3, 5 or 162)
% weightopt (ONLY used for the 162-branch model) - "original" for the default (a priori)
%   weights in the logic tree, or "reweighted" for weights updated using a Bayesian approach.
% It returns weights in the same order as in the coefficient files (DATDT24_Coefficients)

switch brn
    case 3
        branch = [1,2,3];
        weight = [0.185,0.63,0.185];
    case 5
        branch = [1,2,3,4,5];
        weight = [0.101,0.244,0.309,0.244,0.101];
    case 162
        switch weightopt
            case "original"
                ztor = [0.6,0.4];
                sd = [0.185,0.63,0.185];
                k0 = [0.185,0.63,0.185];
                gs = [0.25,0.25,0.5];
                qw = [0.185,0.63,0.185];
                i = 1;
                
                for zi = 1:2 %ZTOR
                    for sti = 1:3 %Stress drop
                        for ki = 1:3 %kappa
                            for gi = 1:3 %geometric mean
                                for qi = 1:3 %Q
                                    branch(i) = i;
                                    weight(i) = ztor(zi) * sd(sti) * k0(ki) * gs(gi) * qw(qi);
                                    i = i + 1;
                                end
                            end
                        end
                    end
                end
            case "reweighted"
                branch = 1:162;
                ztor1_w = [0.000231938709930
                   0.001422360651870
                   0.000739277514770
                   0.000348902666799
                   0.002015601337998
                   0.000962475240216
                   0.002722640045981
                   0.012367752510130
                   0.004199504221503
                   0.000331793586313
                   0.002162242037012
                   0.001255413738265
                   0.000521457279222
                   0.003213933553534
                   0.001726793023224
                   0.004885601772122
                   0.024063975189960
                   0.009469978700956
                   0.000106195800623
                   0.000730827331381
                   0.000467512549288
                   0.000174093003312
                   0.001136496317855
                   0.000675858881133
                   0.001944879800658
                   0.010268650679492
                   0.004555825587203
                   0.003159066242512
                   0.014653051211151
                   0.004971086830007
                   0.004138984052130
                   0.018027324332297
                   0.005596333098585
                   0.018177917749388
                   0.061449876946973
                   0.013346192146388
                   0.005768292638299
                   0.029483828554379
                   0.011906941822367
                   0.007924117969226
                   0.038190413227170
                   0.014219935663594
                   0.042395887272514
                   0.161303327423808
                   0.043343067308908
                   0.002287696316579
                   0.012693765479748
                   0.005883329960045
                   0.003289339089832
                   0.017261453617921
                   0.007410171012834
                   0.021277652315377
                   0.089227837297584
                   0.028157921519883
                   0.001225158811854
                   0.005092491475818
                   0.001460452752730
                   0.001527767448244
                   0.005954548866834
                   0.001559822996351
                   0.005460903866203
                   0.016425750312354
                   0.002988240974095
                   0.002468000476836
                   0.011479356558298
                   0.004027773534491
                   0.003232118749087
                   0.014156890881744
                   0.004572541096722
                   0.014168513533614
                   0.048739753558497
                   0.011288387748890
                   0.001065823176689
                   0.005441873213864
                   0.002227665006151
                   0.001463123632208
                   0.007056429167594
                   0.002671411137327
                   0.007802340860610
                   0.029920543723445
                   0.008275523609205];
                weight = [(ztor1_w.*0.6)',(ztor1_w*0.4)'];
        end
end